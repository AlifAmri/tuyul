{{- if .Values.ingress.enabled }}
apiVersion: configuration.konghq.com/v1
kind: KongPlugin
metadata:
  name: {{ include "api.fullname" . }}-cors
  namespace: {{ .Values.namespace | default .Release.Namespace }}
  labels:
    {{- include "api.labels" . | nindent 4 }}
plugin: cors
config:
  origins:
    - https://tuyul.vercel.app
    - https://tuyul-env.vercel.app
    - http://localhost:5173
    - http://localhost:3000
  methods:
    - GET
    - POST
    - PUT
    - DELETE
    - OPTIONS
    - PATCH
  headers:
    - Content-Type
    - Authorization
    - X-Requested-With
  exposed_headers:
    - Content-Type
    - Authorization
  credentials: true
  max_age: 3600
  preflight_continue: true
  # Don't apply CORS to WebSocket upgrade requests
  # WebSocket connections handle CORS via the application
{{- end }}

